// ============================================================
// MultiGest — Schema do Banco de Dados (Prisma)
// Sistema de Gestão Integrada para Aluguel de Containers
// e Módulos Habitacionais
// ============================================================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================================
// M1 — CORE (Autenticação, Empresas, Usuários)
// ============================================================

model Company {
  id               String   @id @default(uuid())
  cnpj             String   @unique
  razaoSocial      String   @map("razao_social")
  nomeFantasia     String?  @map("nome_fantasia")
  inscricaoEstadual String? @map("inscricao_estadual")
  inscricaoMunicipal String? @map("inscricao_municipal")
  phone            String?
  email            String?
  isActive         Boolean  @default(true) @map("is_active")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  // Endereço
  street           String?
  number           String?
  complement       String?
  neighborhood     String?
  city             String?
  state            String?
  zipCode          String?  @map("zip_code")

  // Relacionamentos
  users            UserCompany[]
  customers        Customer[]
  suppliers        Supplier[]
  assets           Asset[]
  vehicles         Vehicle[]
  drivers          Driver[]
  contracts        Contract[]
  invoices         Invoice[]
  biddings         Bidding[]
  auditLogs        AuditLog[]

  @@map("companies")
}

model User {
  id               String   @id @default(uuid())
  name             String
  email            String   @unique
  passwordHash     String   @map("password_hash")
  role             UserRole @default(OPERATOR)
  isActive         Boolean  @default(true) @map("is_active")
  lastLoginAt      DateTime? @map("last_login_at")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  // Relacionamentos
  companies        UserCompany[]
  auditLogs        AuditLog[]
  collectionActions CollectionAction[]
  transportOrders  TransportOrder[]

  @@map("users")
}

model UserCompany {
  id        String  @id @default(uuid())
  userId    String  @map("user_id")
  companyId String  @map("company_id")

  user      User    @relation(fields: [userId], references: [id])
  company   Company @relation(fields: [companyId], references: [id])

  @@unique([userId, companyId])
  @@map("user_companies")
}

enum UserRole {
  ADMIN
  MANAGER
  OPERATOR
  FINANCIAL
  READONLY
}

model AuditLog {
  id          String   @id @default(uuid())
  userId      String?  @map("user_id")
  companyId   String?  @map("company_id")
  action      String   // CREATE, UPDATE, DELETE, LOGIN, etc.
  entity      String   // Nome da entidade afetada
  entityId    String?  @map("entity_id")
  oldValues   Json?    @map("old_values")
  newValues   Json?    @map("new_values")
  ipAddress   String?  @map("ip_address")
  createdAt   DateTime @default(now()) @map("created_at")

  user        User?    @relation(fields: [userId], references: [id])
  company     Company? @relation(fields: [companyId], references: [id])

  @@index([entity, entityId])
  @@index([userId])
  @@index([createdAt])
  @@map("audit_logs")
}

// ============================================================
// M2 — CADASTROS COMPARTILHADOS (Clientes, Fornecedores)
// ============================================================

model Customer {
  id                 String   @id @default(uuid())
  companyId          String   @map("company_id")
  code               String?  // Código interno legível
  type               PersonType @default(JURIDICA)
  cpfCnpj            String   @map("cpf_cnpj")
  razaoSocial        String   @map("razao_social")
  nomeFantasia       String?  @map("nome_fantasia")
  inscricaoEstadual  String?  @map("inscricao_estadual")
  inscricaoMunicipal String?  @map("inscricao_municipal")
  segment            String?  // Segmento do cliente (petróleo, construção, etc.)
  notes              String?
  isDefaulter        Boolean  @default(false) @map("is_defaulter") // Inadimplente
  isActive           Boolean  @default(true) @map("is_active")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")
  deletedAt          DateTime? @map("deleted_at") // Soft delete

  // Relacionamentos
  company            Company  @relation(fields: [companyId], references: [id])
  addresses          Address[] @relation("CustomerAddresses")
  contacts           Contact[] @relation("CustomerContacts")
  contracts          Contract[]
  invoices           Invoice[]
  defaulterRecords   DefaulterRecord[]

  @@unique([companyId, cpfCnpj])
  @@index([companyId])
  @@index([razaoSocial])
  @@map("customers")
}

model Supplier {
  id                 String   @id @default(uuid())
  companyId          String   @map("company_id")
  code               String?
  type               PersonType @default(JURIDICA)
  cpfCnpj            String   @map("cpf_cnpj")
  razaoSocial        String   @map("razao_social")
  nomeFantasia       String?  @map("nome_fantasia")
  category           String?  // Categoria (manutenção, combustível, peças, etc.)
  notes              String?
  isActive           Boolean  @default(true) @map("is_active")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")
  deletedAt          DateTime? @map("deleted_at")

  company            Company  @relation(fields: [companyId], references: [id])
  addresses          Address[] @relation("SupplierAddresses")
  contacts           Contact[] @relation("SupplierContacts")
  assetMaintenances  AssetMaintenance[]
  vehicleMaintenances VehicleMaintenance[]

  @@unique([companyId, cpfCnpj])
  @@index([companyId])
  @@map("suppliers")
}

enum PersonType {
  FISICA
  JURIDICA
}

model Address {
  id            String  @id @default(uuid())
  street        String
  number        String?
  complement    String?
  neighborhood  String?
  city          String
  state         String
  zipCode       String? @map("zip_code")
  label         String? // "Principal", "Entrega", "Cobrança"
  isMain        Boolean @default(false) @map("is_main")

  // Polimórfico — vinculado a Customer OU Supplier
  customerId    String? @map("customer_id")
  supplierId    String? @map("supplier_id")
  customer      Customer? @relation("CustomerAddresses", fields: [customerId], references: [id])
  supplier      Supplier? @relation("SupplierAddresses", fields: [supplierId], references: [id])

  @@map("addresses")
}

model Contact {
  id            String  @id @default(uuid())
  name          String
  role          String? // Cargo/função
  phone         String?
  cellphone     String?
  email         String?
  isMain        Boolean @default(false) @map("is_main")

  customerId    String? @map("customer_id")
  supplierId    String? @map("supplier_id")
  customer      Customer? @relation("CustomerContacts", fields: [customerId], references: [id])
  supplier      Supplier? @relation("SupplierContacts", fields: [supplierId], references: [id])

  @@map("contacts")
}

// ============================================================
// M4 — ATIVOS (Containers e Módulos Habitacionais)
// ============================================================

model AssetType {
  id           String  @id @default(uuid())
  name         String  // "Container 20'", "Container 40'", "Módulo Habitacional", etc.
  description  String?
  isActive     Boolean @default(true) @map("is_active")

  assets       Asset[]

  @@map("asset_types")
}

model Asset {
  id                String      @id @default(uuid())
  companyId         String      @map("company_id")
  assetTypeId       String      @map("asset_type_id")
  code              String      // Código patrimônio (ex: "CNT-001")
  serialNumber      String?     @map("serial_number")
  manufacturingYear Int?        @map("manufacturing_year")
  manufacturer      String?
  width             Decimal?    @db.Decimal(10, 2)
  height            Decimal?    @db.Decimal(10, 2)
  length            Decimal?    @db.Decimal(10, 2)
  condition         AssetCondition @default(GOOD)
  status            AssetStatus @default(AVAILABLE)
  currentLocation   String?     @map("current_location") // Descrição da localização atual
  dailyRate         Decimal?    @db.Decimal(12, 2) @map("daily_rate") // Valor diária padrão
  notes             String?
  isActive          Boolean     @default(true) @map("is_active")
  createdAt         DateTime    @default(now()) @map("created_at")
  updatedAt         DateTime    @updatedAt @map("updated_at")
  deletedAt         DateTime?   @map("deleted_at")

  // Relacionamentos
  company           Company     @relation(fields: [companyId], references: [id])
  assetType         AssetType   @relation(fields: [assetTypeId], references: [id])
  statusHistory     AssetStatusHistory[]
  maintenances      AssetMaintenance[]
  contractItems     ContractItem[]
  transportOrders   TransportOrder[]

  @@unique([companyId, code])
  @@index([companyId])
  @@index([status])
  @@map("assets")
}

enum AssetStatus {
  AVAILABLE       // Disponível no pátio
  RENTED          // Alugado (em contrato)
  IN_MAINTENANCE  // Em manutenção
  IN_TRANSIT      // Em trânsito
  DECOMMISSIONED  // Baixado (sucata/venda/perda)
}

enum AssetCondition {
  EXCELLENT
  GOOD
  FAIR
  POOR
}

model AssetStatusHistory {
  id          String      @id @default(uuid())
  assetId     String      @map("asset_id")
  fromStatus  AssetStatus? @map("from_status")
  toStatus    AssetStatus @map("to_status")
  reason      String?
  changedBy   String?     @map("changed_by") // userId
  createdAt   DateTime    @default(now()) @map("created_at")

  asset       Asset       @relation(fields: [assetId], references: [id])

  @@index([assetId])
  @@map("asset_status_history")
}

model AssetMaintenance {
  id             String   @id @default(uuid())
  assetId        String   @map("asset_id")
  supplierId     String?  @map("supplier_id")
  type           MaintenanceType @default(CORRECTIVE)
  description    String
  cost           Decimal? @db.Decimal(12, 2)
  startDate      DateTime @map("start_date")
  endDate        DateTime? @map("end_date")
  notes          String?
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  asset          Asset    @relation(fields: [assetId], references: [id])
  supplier       Supplier? @relation(fields: [supplierId], references: [id])

  @@index([assetId])
  @@map("asset_maintenances")
}

enum MaintenanceType {
  PREVENTIVE
  CORRECTIVE
}

// ============================================================
// M3 — CONTRATOS (Gestão de Contratos de Aluguel)
// ============================================================

model Contract {
  id               String         @id @default(uuid())
  companyId        String         @map("company_id")
  customerId       String         @map("customer_id")
  contractNumber   String         @map("contract_number") // Número do contrato legível
  status           ContractStatus @default(DRAFT)
  startDate        DateTime       @map("start_date")
  endDate          DateTime?      @map("end_date")
  paymentTerms     String?        @map("payment_terms") // Condições de pagamento
  paymentMethod    String?        @map("payment_method") // Forma de pagamento
  notes            String?
  totalMonthlyValue Decimal?      @db.Decimal(14, 2) @map("total_monthly_value")
  createdAt        DateTime       @default(now()) @map("created_at")
  updatedAt        DateTime       @updatedAt @map("updated_at")
  deletedAt        DateTime?      @map("deleted_at")

  // Relacionamentos
  company          Company        @relation(fields: [companyId], references: [id])
  customer         Customer       @relation(fields: [customerId], references: [id])
  items            ContractItem[]
  addendums        ContractAddendum[]
  measurements     Measurement[]
  movements        ContractMovement[]
  invoices         Invoice[]

  @@unique([companyId, contractNumber])
  @@index([companyId])
  @@index([customerId])
  @@index([status])
  @@map("contracts")
}

enum ContractStatus {
  DRAFT       // Rascunho
  ACTIVE      // Ativo
  SUSPENDED   // Suspenso
  TERMINATED  // Encerrado
  CANCELLED   // Cancelado
}

model ContractItem {
  id            String   @id @default(uuid())
  contractId    String   @map("contract_id")
  assetId       String   @map("asset_id")
  dailyRate     Decimal  @db.Decimal(12, 2) @map("daily_rate")
  monthlyRate   Decimal? @db.Decimal(12, 2) @map("monthly_rate")
  startDate     DateTime @map("start_date")
  endDate       DateTime? @map("end_date")
  isActive      Boolean  @default(true) @map("is_active")
  notes         String?
  createdAt     DateTime @default(now()) @map("created_at")

  contract      Contract @relation(fields: [contractId], references: [id])
  asset         Asset    @relation(fields: [assetId], references: [id])
  measurementItems MeasurementItem[]

  @@index([contractId])
  @@map("contract_items")
}

model ContractAddendum {
  id            String       @id @default(uuid())
  contractId    String       @map("contract_id")
  addendumNumber Int         @map("addendum_number")
  type          AddendumType
  description   String
  effectiveDate DateTime     @map("effective_date")
  notes         String?
  createdAt     DateTime     @default(now()) @map("created_at")

  contract      Contract     @relation(fields: [contractId], references: [id])

  @@index([contractId])
  @@map("contract_addendums")
}

enum AddendumType {
  EXTENSION        // Prorrogação
  ITEM_ADDITION    // Inclusão de itens
  ITEM_REMOVAL     // Remoção de itens
  PRICE_ADJUSTMENT // Reajuste de preço
  PARTIAL_CLOSURE  // Encerramento parcial
  OTHER
}

model Measurement {
  id            String   @id @default(uuid())
  contractId    String   @map("contract_id")
  periodStart   DateTime @map("period_start")
  periodEnd     DateTime @map("period_end")
  totalValue    Decimal  @db.Decimal(14, 2) @map("total_value")
  status        MeasurementStatus @default(DRAFT)
  notes         String?
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  contract      Contract @relation(fields: [contractId], references: [id])
  items         MeasurementItem[]
  invoice       Invoice?

  @@index([contractId])
  @@map("measurements")
}

model MeasurementItem {
  id              String       @id @default(uuid())
  measurementId   String       @map("measurement_id")
  contractItemId  String       @map("contract_item_id")
  days            Int          // Número de dias medidos
  dailyRate       Decimal      @db.Decimal(12, 2) @map("daily_rate")
  totalValue      Decimal      @db.Decimal(14, 2) @map("total_value")

  measurement     Measurement  @relation(fields: [measurementId], references: [id])
  contractItem    ContractItem @relation(fields: [contractItemId], references: [id])

  @@map("measurement_items")
}

enum MeasurementStatus {
  DRAFT
  APPROVED
  INVOICED
  CANCELLED
}

model ContractMovement {
  id            String       @id @default(uuid())
  contractId    String       @map("contract_id")
  type          MovementType
  assetCode     String?      @map("asset_code")
  movementDate  DateTime     @map("movement_date")
  address       String?      // Endereço de entrega/recolhimento
  notes         String?
  createdAt     DateTime     @default(now()) @map("created_at")

  contract      Contract     @relation(fields: [contractId], references: [id])

  @@index([contractId])
  @@map("contract_movements")
}

enum MovementType {
  DELIVERY    // Entrega no cliente
  PICKUP      // Recolhimento do cliente
  SWAP        // Troca
}

// ============================================================
// M5 — FROTA (Veículos, Motoristas, Transporte)
// ============================================================

model Vehicle {
  id               String   @id @default(uuid())
  companyId        String   @map("company_id")
  plate            String   @unique
  type             String   // Caminhão, Carreta, Cavalo Mecânico, etc.
  brand            String?
  model            String?
  year             Int?
  renavam          String?
  loadCapacityKg   Decimal? @db.Decimal(10, 2) @map("load_capacity_kg")
  currentKm        Int?     @map("current_km")
  status           VehicleStatus @default(AVAILABLE)
  isActive         Boolean  @default(true) @map("is_active")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")
  deletedAt        DateTime? @map("deleted_at")

  company          Company  @relation(fields: [companyId], references: [id])
  transportOrders  TransportOrder[]
  checklists       VehicleChecklist[]
  fuelRecords      FuelRecord[]
  maintenances     VehicleMaintenance[]

  @@index([companyId])
  @@map("vehicles")
}

enum VehicleStatus {
  AVAILABLE
  IN_OPERATION
  IN_MAINTENANCE
  DECOMMISSIONED
}

model Driver {
  id               String   @id @default(uuid())
  companyId        String   @map("company_id")
  name             String
  cpf              String   @unique
  cnhNumber        String   @map("cnh_number")
  cnhCategory      String   @map("cnh_category") // A, B, C, D, E
  cnhExpiry        DateTime @map("cnh_expiry")
  phone            String?
  isActive         Boolean  @default(true) @map("is_active")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  company          Company  @relation(fields: [companyId], references: [id])
  transportOrders  TransportOrder[]

  @@index([companyId])
  @@map("drivers")
}

model VehicleChecklist {
  id          String   @id @default(uuid())
  vehicleId   String   @map("vehicle_id")
  checkDate   DateTime @map("check_date")
  checkedBy   String   @map("checked_by") // Nome ou userId
  items       Json     // Array de { item: string, status: "OK"|"NOK", notes?: string }
  overallStatus String @map("overall_status") // "APPROVED", "REJECTED", "CONDITIONAL"
  notes       String?
  createdAt   DateTime @default(now()) @map("created_at")

  vehicle     Vehicle  @relation(fields: [vehicleId], references: [id])

  @@index([vehicleId])
  @@map("vehicle_checklists")
}

model TransportOrder {
  id              String             @id @default(uuid())
  vehicleId       String?            @map("vehicle_id")
  driverId        String?            @map("driver_id")
  assetId         String?            @map("asset_id")
  requestedBy     String?            @map("requested_by") // userId
  orderNumber     String             @map("order_number")
  type            TransportOrderType
  origin          String
  destination     String
  scheduledDate   DateTime           @map("scheduled_date")
  completedDate   DateTime?          @map("completed_date")
  status          TransportOrderStatus @default(PENDING)
  notes           String?
  createdAt       DateTime           @default(now()) @map("created_at")
  updatedAt       DateTime           @updatedAt @map("updated_at")

  vehicle         Vehicle?           @relation(fields: [vehicleId], references: [id])
  driver          Driver?            @relation(fields: [driverId], references: [id])
  asset           Asset?             @relation(fields: [assetId], references: [id])
  requestedByUser User?              @relation(fields: [requestedBy], references: [id])

  @@index([status])
  @@map("transport_orders")
}

enum TransportOrderType {
  DELIVERY
  PICKUP
  TRANSFER
}

enum TransportOrderStatus {
  PENDING
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

model FuelRecord {
  id          String   @id @default(uuid())
  vehicleId   String   @map("vehicle_id")
  date        DateTime
  liters      Decimal  @db.Decimal(10, 2)
  totalCost   Decimal  @db.Decimal(12, 2) @map("total_cost")
  currentKm   Int      @map("current_km")
  station     String?
  notes       String?
  createdAt   DateTime @default(now()) @map("created_at")

  vehicle     Vehicle  @relation(fields: [vehicleId], references: [id])

  @@index([vehicleId])
  @@map("fuel_records")
}

model VehicleMaintenance {
  id            String   @id @default(uuid())
  vehicleId     String   @map("vehicle_id")
  supplierId    String?  @map("supplier_id")
  type          MaintenanceType @default(CORRECTIVE)
  description   String
  cost          Decimal? @db.Decimal(12, 2)
  currentKm     Int?     @map("current_km")
  startDate     DateTime @map("start_date")
  endDate       DateTime? @map("end_date")
  partsReplaced String?  @map("parts_replaced")
  notes         String?
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  vehicle       Vehicle  @relation(fields: [vehicleId], references: [id])
  supplier      Supplier? @relation(fields: [supplierId], references: [id])

  @@index([vehicleId])
  @@map("vehicle_maintenances")
}

// ============================================================
// M6 — COBRANÇA (Títulos, Inadimplência, Acordos)
// ============================================================

model Invoice {
  id               String        @id @default(uuid())
  companyId        String        @map("company_id")
  customerId       String        @map("customer_id")
  contractId       String?       @map("contract_id")
  measurementId    String?       @unique @map("measurement_id")
  invoiceNumber    String        @map("invoice_number")
  issueDate        DateTime      @map("issue_date")
  dueDate          DateTime      @map("due_date")
  amount           Decimal       @db.Decimal(14, 2)
  paidAmount       Decimal       @default(0) @db.Decimal(14, 2) @map("paid_amount")
  status           InvoiceStatus @default(OPEN)
  notes            String?
  createdAt        DateTime      @default(now()) @map("created_at")
  updatedAt        DateTime      @updatedAt @map("updated_at")

  company          Company       @relation(fields: [companyId], references: [id])
  customer         Customer      @relation(fields: [customerId], references: [id])
  contract         Contract?     @relation(fields: [contractId], references: [id])
  measurement      Measurement?  @relation(fields: [measurementId], references: [id])
  payments         InvoicePayment[]
  collectionActions CollectionAction[]

  @@unique([companyId, invoiceNumber])
  @@index([companyId])
  @@index([customerId])
  @@index([status])
  @@index([dueDate])
  @@map("invoices")
}

enum InvoiceStatus {
  OPEN           // Em aberto
  PAID           // Pago
  PARTIALLY_PAID // Parcialmente pago
  OVERDUE        // Vencido
  IN_AGREEMENT   // Em acordo
  CANCELLED      // Cancelado
  WRITTEN_OFF    // Baixado (prejuízo)
}

model InvoicePayment {
  id            String   @id @default(uuid())
  invoiceId     String   @map("invoice_id")
  paymentDate   DateTime @map("payment_date")
  amount        Decimal  @db.Decimal(14, 2)
  paymentMethod String?  @map("payment_method") // Boleto, PIX, Transferência, etc.
  bankAccount   String?  @map("bank_account")
  reference     String?  // Número do comprovante
  notes         String?
  createdAt     DateTime @default(now()) @map("created_at")

  invoice       Invoice  @relation(fields: [invoiceId], references: [id])

  @@index([invoiceId])
  @@map("invoice_payments")
}

model DefaulterRecord {
  id            String   @id @default(uuid())
  customerId    String   @map("customer_id")
  startDate     DateTime @map("start_date")
  endDate       DateTime? @map("end_date")
  totalDebt     Decimal  @db.Decimal(14, 2) @map("total_debt")
  reason        String?
  isResolved    Boolean  @default(false) @map("is_resolved")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  customer      Customer @relation(fields: [customerId], references: [id])
  agreement     PaymentAgreement?

  @@index([customerId])
  @@map("defaulter_records")
}

model CollectionAction {
  id               String   @id @default(uuid())
  invoiceId        String   @map("invoice_id")
  performedById    String?  @map("performed_by_id")
  type             CollectionActionType
  actionDate       DateTime @map("action_date")
  description      String?
  result           String?
  nextActionDate   DateTime? @map("next_action_date")
  createdAt        DateTime @default(now()) @map("created_at")

  invoice          Invoice  @relation(fields: [invoiceId], references: [id])
  performedBy      User?    @relation(fields: [performedById], references: [id])

  @@index([invoiceId])
  @@map("collection_actions")
}

enum CollectionActionType {
  PHONE_CALL
  EMAIL
  LETTER
  PROTEST
  LEGAL
  VISIT
  OTHER
}

model PaymentAgreement {
  id                String   @id @default(uuid())
  defaulterRecordId String   @unique @map("defaulter_record_id")
  agreementDate     DateTime @map("agreement_date")
  originalDebt      Decimal  @db.Decimal(14, 2) @map("original_debt")
  discountPercent   Decimal? @db.Decimal(5, 2) @map("discount_percent")
  finalAmount       Decimal  @db.Decimal(14, 2) @map("final_amount")
  installments      Int
  notes             String?
  status            AgreementStatus @default(ACTIVE)
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")

  defaulterRecord   DefaulterRecord @relation(fields: [defaulterRecordId], references: [id])

  @@map("payment_agreements")
}

enum AgreementStatus {
  ACTIVE
  COMPLETED
  BROKEN
  CANCELLED
}

model Bidding {
  id             String        @id @default(uuid())
  companyId      String        @map("company_id")
  biddingNumber  String        @map("bidding_number")
  title          String
  description    String?
  openingDate    DateTime      @map("opening_date")
  closingDate    DateTime?     @map("closing_date")
  estimatedValue Decimal?      @db.Decimal(14, 2) @map("estimated_value")
  status         BiddingStatus @default(OPEN)
  requiredDocs   String?       @map("required_docs")
  notes          String?
  createdAt      DateTime      @default(now()) @map("created_at")
  updatedAt      DateTime      @updatedAt @map("updated_at")

  company        Company       @relation(fields: [companyId], references: [id])

  @@index([companyId])
  @@map("biddings")
}

enum BiddingStatus {
  OPEN
  IN_ANALYSIS
  WON
  LOST
  CANCELLED
}
